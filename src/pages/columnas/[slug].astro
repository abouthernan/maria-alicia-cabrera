---
import Footer from "../../components/Footer.astro";
import Header from "../../components/Header.astro";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const url = `${import.meta.env.PUBLIC_API_URL}/api/columns`;
  const response = await fetch(url);
  const { data } = await response.json();
  
  // Validar que data existe y es un array
  const columns = Array.isArray(data) ? data : [];
  
  return columns.map((column) => ({
    params: { slug: column.attributes.identifier },
    props: { column }
  }));
}

const { column } = Astro.props;
const { slug } = Astro.params;

// Si no hay columna, redirigir a 404
if (!column) return Astro.redirect("/404");
---

<Layout title={`${column.attributes.title} - MarÃ­a Alicia Cabrera`}>
  <Header />
  <main>
    <article>
      <h1>{column.attributes.title}</h1>
      <p>{column.attributes.description}</p>
    </article>
  </main>
  <Footer />
</Layout>

<style>
  main {
    margin: 0;
    padding: 2rem 0;
    min-height: 100vh;
    background: var(--cream);
  }

  article {
    max-width: 900px;
    margin: 4rem auto 0;
    background: var(--white);
    padding: 2rem 2rem 5rem;
  }

  h1 {
    text-align: center;
    font-weight: 700;
    font-size: 3rem;
    font-weight: 400;
  }

  p {
    max-width: 80ch;
    margin: 0 auto;
    text-align: justify;
    font-family: var(--font-body);
    line-height: 1.5;
  }

  @media (min-width: 768px) {
    main {
      padding: 8rem 0;
    }

    h1 {
      font-size: var(--font-xl);
    }

    article {
      padding: 2rem 4rem 8rem;
    }
  }
</style>
